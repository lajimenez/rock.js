<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.line {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class='line'>  1</span> <span class="COMM">/**
<span class='line'>  2</span>  * Represents base object for rock framework
<span class='line'>  3</span>  *
<span class='line'>  4</span>  * @class
<span class='line'>  5</span>  * @author Luis Alberto Jim√©nez
<span class='line'>  6</span>  */</span><span class="WHIT">
<span class='line'>  7</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">rock</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>  8</span> 
<span class='line'>  9</span>     </span><span class="COMM">/**
<span class='line'> 10</span>      * Rock framework version
<span class='line'> 11</span>      */</span><span class="WHIT">
<span class='line'> 12</span>     </span><span class="NAME">version</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'r1'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 13</span> 
<span class='line'> 14</span>     </span><span class="COMM">/**
<span class='line'> 15</span>      * Array with reserved properties
<span class='line'> 16</span>      */</span><span class="WHIT">
<span class='line'> 17</span>     </span><span class="NAME">reservedProperties</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">'super_'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'isInterface_'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'interfaces_'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'nextSuperToCall_'</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 18</span> 
<span class='line'> 19</span>     </span><span class="COMM">/**
<span class='line'> 20</span>      * Add a namespace if it doesn't exists
<span class='line'> 21</span>      */</span><span class="WHIT">
<span class='line'> 22</span>     </span><span class="NAME">namespace</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">namespace</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 23</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parts</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">namespace.split</span><span class="PUNC">(</span><span class="STRN">'.'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 24</span> 
<span class='line'> 25</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">lastVar</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 26</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">currentVar</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 27</span>         </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">parts.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 28</span> 
<span class='line'> 29</span>             </span><span class="NAME">currentVar</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">lastVar</span><span class="PUNC">[</span><span class="NAME">parts</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 30</span> 
<span class='line'> 31</span>             </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isNullOrUndefined</span><span class="PUNC">(</span><span class="NAME">currentVar</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 32</span>                 </span><span class="NAME">lastVar</span><span class="PUNC">[</span><span class="NAME">parts</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 33</span>             </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 34</span> 
<span class='line'> 35</span>             </span><span class="NAME">lastVar</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">lastVar</span><span class="PUNC">[</span><span class="NAME">parts</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 36</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 37</span>     </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 38</span> 
<span class='line'> 39</span>     </span><span class="COMM">/**
<span class='line'> 40</span>      * Check if the name of the property is a reserved name property
<span class='line'> 41</span>      *
<span class='line'> 42</span>      * @param property
<span class='line'> 43</span>      *            the name of the property to check
<span class='line'> 44</span>      */</span><span class="WHIT">
<span class='line'> 45</span>     </span><span class="NAME">isReservedProperty</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">property</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 46</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isNullOrUndefined</span><span class="PUNC">(</span><span class="NAME">property</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 47</span>             </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 48</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 49</span> 
<span class='line'> 50</span>         </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this.reservedProperties.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 51</span>             </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">property</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">this.reservedProperties</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 52</span>                 </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 53</span>             </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 54</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 55</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 56</span>     </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 57</span> 
<span class='line'> 58</span>     </span><span class="COMM">/**
<span class='line'> 59</span>      * Define a function as an interface
<span class='line'> 60</span>      *
<span class='line'> 61</span>      * @param constructorFunc
<span class='line'> 62</span>      *            the constructor to be set as an interface
<span class='line'> 63</span>      */</span><span class="WHIT">
<span class='line'> 64</span>     </span><span class="NAME">interface_</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">constructorFunc</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 65</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.isFunction</span><span class="PUNC">(</span><span class="NAME">constructorFunc</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 66</span>             </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">rock.error.RockError</span><span class="PUNC">(</span><span class="NAME">rock.resource.rockResourceManager.getString</span><span class="PUNC">(</span><span class="STRN">'NO_FUNCTION_TYPE'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 67</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 68</span> 
<span class='line'> 69</span>         </span><span class="NAME">constructorFunc.prototype.isInterface_</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 70</span>     </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 71</span> 
<span class='line'> 72</span>     </span><span class="COMM">/**
<span class='line'> 73</span>      * Check if an element is a function
<span class='line'> 74</span>      *
<span class='line'> 75</span>      * @param element
<span class='line'> 76</span>      *            the element to check
<span class='line'> 77</span>      */</span><span class="WHIT">
<span class='line'> 78</span>     </span><span class="NAME">isFunction</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">element</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 79</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">element</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">rock.constants.TYPE_FUNCTION</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 80</span>     </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 81</span> 
<span class='line'> 82</span>     </span><span class="COMM">/**
<span class='line'> 83</span>      * Check if a function is an interface
<span class='line'> 84</span>      *
<span class='line'> 85</span>      * @param constructorFunc
<span class='line'> 86</span>      *            the constructor to check
<span class='line'> 87</span>      */</span><span class="WHIT">
<span class='line'> 88</span>     </span><span class="NAME">isInterface_</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">constructorFunc</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 89</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.isFunction</span><span class="PUNC">(</span><span class="NAME">constructorFunc</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 90</span>             </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 91</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 92</span> 
<span class='line'> 93</span>         </span><span class="COMM">// A function can only implement interfaces. Rock</span><span class="WHIT">
<span class='line'> 94</span>         </span><span class="COMM">// uses internal property 'isInterface_' to save</span><span class="WHIT">
<span class='line'> 95</span>         </span><span class="COMM">// this information</span><span class="WHIT">
<span class='line'> 96</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isNullOrUndefined</span><span class="PUNC">(</span><span class="NAME">constructorFunc.prototype.isInterface_</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 97</span>             </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 98</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 99</span> 
<span class='line'>100</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">constructorFunc.prototype.isInterface_</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>101</span>     </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>102</span> 
<span class='line'>103</span>     </span><span class="COMM">/**
<span class='line'>104</span>      * Mark a class to implement some interface
<span class='line'>105</span>      *
<span class='line'>106</span>      * @param constructorFunc
<span class='line'>107</span>      *            the constructor that implements the interface
<span class='line'>108</span>      * @param interfaceFunc
<span class='line'>109</span>      *            the interface to implement
<span class='line'>110</span>      */</span><span class="WHIT">
<span class='line'>111</span>     </span><span class="NAME">implements_</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">constructorFunc</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">interfaceFunc</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>112</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.isFunction</span><span class="PUNC">(</span><span class="NAME">constructorFunc</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>113</span>             </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this.isFunction</span><span class="PUNC">(</span><span class="NAME">interfaceFunc</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>114</span>             </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">rock.error.RockError</span><span class="PUNC">(</span><span class="NAME">rock.resource.rockResourceManager.getString</span><span class="PUNC">(</span><span class="STRN">'NO_FUNCTION_TYPE'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>115</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>116</span> 
<span class='line'>117</span>         </span><span class="COMM">// An interface can't implement nothing</span><span class="WHIT">
<span class='line'>118</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isInterface_</span><span class="PUNC">(</span><span class="NAME">constructorFunc</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>119</span>             </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">rock.error.RockError</span><span class="PUNC">(</span><span class="NAME">rock.resource.rockResourceManager.getString</span><span class="PUNC">(</span><span class="STRN">'INTERFACE_CANT_IMPLEMENT'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>120</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>121</span> 
<span class='line'>122</span>         </span><span class="COMM">// Only an interface can be implemented</span><span class="WHIT">
<span class='line'>123</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.isInterface_</span><span class="PUNC">(</span><span class="NAME">interfaceFunc</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>124</span>             </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">rock.error.RockError</span><span class="PUNC">(</span><span class="NAME">rock.resource.rockResourceManager.getString</span><span class="PUNC">(</span><span class="STRN">'ONLY_INTERFACE_CAN_BE_IMPLEMENTED'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>125</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>126</span> 
<span class='line'>127</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isNullOrUndefined</span><span class="PUNC">(</span><span class="NAME">constructorFunc.prototype.interfaces_</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>128</span>             </span><span class="NAME">constructorFunc.prototype.interfaces_</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>129</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>130</span> 
<span class='line'>131</span>         </span><span class="NAME">constructorFunc.prototype.interfaces_.push</span><span class="PUNC">(</span><span class="NAME">interfaceFunc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>132</span> 
<span class='line'>133</span>         </span><span class="COMM">// Add all elements from interface prototype</span><span class="WHIT">
<span class='line'>134</span>         </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">property</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">interfaceFunc.prototype</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>135</span>             </span><span class="COMM">// we don't want to replace any existing element. And we don't</span><span class="WHIT">
<span class='line'>136</span>             </span><span class="COMM">// want to add reserved properties, for example 'isInterface_'</span><span class="WHIT">
<span class='line'>137</span>             </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">constructorFunc.prototype</span><span class="PUNC">[</span><span class="NAME">property</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="WHIT">
<span class='line'>138</span>                 </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this.isReservedProperty</span><span class="PUNC">(</span><span class="NAME">property</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>139</span>                 </span><span class="NAME">constructorFunc.prototype</span><span class="PUNC">[</span><span class="NAME">property</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">interfaceFunc.prototype</span><span class="PUNC">[</span><span class="NAME">property</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>140</span>             </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>141</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>142</span>     </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>143</span> 
<span class='line'>144</span>     </span><span class="COMM">/**
<span class='line'>145</span>      * Implements inheritance in rock
<span class='line'>146</span>      *
<span class='line'>147</span>      * @param constructorFunc
<span class='line'>148</span>      *            the constructor that extends
<span class='line'>149</span>      * @param superConstructorFunc
<span class='line'>150</span>      *            the constructor to be extended
<span class='line'>151</span>      */</span><span class="WHIT">
<span class='line'>152</span>     </span><span class="NAME">extends_</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">constructorFunc</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">superConstructorFunc</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>153</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.isFunction</span><span class="PUNC">(</span><span class="NAME">constructorFunc</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>154</span>             </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this.isFunction</span><span class="PUNC">(</span><span class="NAME">superConstructorFunc</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>155</span>             </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">rock.error.RockError</span><span class="PUNC">(</span><span class="NAME">rock.resource.rockResourceManager.getString</span><span class="PUNC">(</span><span class="STRN">'NO_FUNCTION_TYPE'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>156</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>157</span> 
<span class='line'>158</span>         </span><span class="COMM">// Class extends class and interface extends interface</span><span class="WHIT">
<span class='line'>159</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isInterface_</span><span class="PUNC">(</span><span class="NAME">constructorFunc</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">this.isInterface_</span><span class="PUNC">(</span><span class="NAME">superConstructorFunc</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>160</span>             </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">rock.error.RockError</span><span class="PUNC">(</span><span class="NAME">rock.resource.rockResourceManager.getString</span><span class="PUNC">(</span><span class="STRN">'INVALID_EXTENSION'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>161</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>162</span> 
<span class='line'>163</span>         </span><span class="COMM">// Validation: To define a new class, first must be 'extends' then</span><span class="WHIT">
<span class='line'>164</span>         </span><span class="COMM">// 'implements', so class that 'implements' any interface can't</span><span class="WHIT">
<span class='line'>165</span>         </span><span class="COMM">// 'extends'</span><span class="WHIT">
<span class='line'>166</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.isInterface_</span><span class="PUNC">(</span><span class="NAME">constructorFunc</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>167</span>             </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this.isNullOrUndefined</span><span class="PUNC">(</span><span class="NAME">constructorFunc.prototype.interfaces_</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>168</span>             </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">constructorFunc.prototype.interfaces_.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>169</span>                 </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">rock.error.RockError</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>170</span>                     </span><span class="NAME">rock.resource.rockResourceManager.getString</span><span class="PUNC">(</span><span class="STRN">'INVALID_INHERITANCE_EXTENDS_BEFORE_IMPLEMENTS'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>171</span>             </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>172</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>173</span> 
<span class='line'>174</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">super_</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">superConstructorFunc</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>175</span>         </span><span class="NAME">constructorFunc.prototype.super_</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">super_</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>176</span> 
<span class='line'>177</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isNullOrUndefined</span><span class="PUNC">(</span><span class="NAME">super_.prototype</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>178</span>             </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>179</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>180</span> 
<span class='line'>181</span>         </span><span class="COMM">// Add all elements from prototype</span><span class="WHIT">
<span class='line'>182</span>         </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">property</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">super_.prototype</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>183</span> 
<span class='line'>184</span>             </span><span class="COMM">// we don't want to replace any existing element, for example</span><span class="WHIT">
<span class='line'>185</span>             </span><span class="COMM">// 'super_'</span><span class="WHIT">
<span class='line'>186</span>             </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">constructorFunc.prototype</span><span class="PUNC">[</span><span class="NAME">property</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="WHIT">
<span class='line'>187</span>                 </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this.isReservedProperty</span><span class="PUNC">(</span><span class="NAME">property</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>188</span>                 </span><span class="NAME">constructorFunc.prototype</span><span class="PUNC">[</span><span class="NAME">property</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">super_.prototype</span><span class="PUNC">[</span><span class="NAME">property</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>189</span>             </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>190</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>191</span>     </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>192</span> 
<span class='line'>193</span>     </span><span class="COMM">/**
<span class='line'>194</span>      * Call super constructor
<span class='line'>195</span>      *
<span class='line'>196</span>      * @param object
<span class='line'>197</span>      *            the object that call super
<span class='line'>198</span>      * @param {Array} [params]
<span class='line'>199</span>      *            parameters to use on the super constructor.
<span class='line'>200</span>      */</span><span class="WHIT">
<span class='line'>201</span>     </span><span class="NAME">super_</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">object</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">params</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>202</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">superConstructor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">object.nextSuperToCall_</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">object.super_</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>203</span> 
<span class='line'>204</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isNullOrUndefined</span><span class="PUNC">(</span><span class="NAME">superConstructor</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>205</span>             </span><span class="COMM">// Throw exception here?</span><span class="WHIT">
<span class='line'>206</span>             </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>207</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>208</span> 
<span class='line'>209</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">constructor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">object.constructor</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>210</span>         </span><span class="NAME">rock.invokeSuper</span><span class="PUNC">(</span><span class="NAME">object</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">constructor</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">superConstructor</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">params</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>211</span>     </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>212</span> 
<span class='line'>213</span>     </span><span class="COMM">/**
<span class='line'>214</span>      * We simulate invocation to a constructor of a superclass.
<span class='line'>215</span>      *
<span class='line'>216</span>      * @param object
<span class='line'>217</span>      *            the object under construction
<span class='line'>218</span>      * @param constructor
<span class='line'>219</span>      *            the constructor
<span class='line'>220</span>      * @param superConstructor
<span class='line'>221</span>      *            the superclass constructor
<span class='line'>222</span>      * @param params
<span class='line'>223</span>      *            the parameters
<span class='line'>224</span>      * @returns an object
<span class='line'>225</span>      */</span><span class="WHIT">
<span class='line'>226</span>     </span><span class="NAME">invokeSuper</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">object</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">constructor</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">superConstructor</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">params</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>227</span>         </span><span class="NAME">object.nextSuperToCall_</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">superConstructor.prototype.super_</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>228</span>         </span><span class="NAME">superConstructor.apply</span><span class="PUNC">(</span><span class="NAME">object</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">params</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>229</span>         </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">object.nextSuperToCall_</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>230</span>     </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>231</span> 
<span class='line'>232</span>     </span><span class="COMM">/**
<span class='line'>233</span>      * Add properties in other object.
<span class='line'>234</span>      *
<span class='line'>235</span>      * @param toObject
<span class='line'>236</span>      *            the object to add properties
<span class='line'>237</span>      * @param fromObject
<span class='line'>238</span>      *            the object where to get properties
<span class='line'>239</span>      */</span><span class="WHIT">
<span class='line'>240</span>     </span><span class="NAME">addProperties</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">toObject</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">fromObject</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>241</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">property</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>242</span>         </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">property</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">fromObject</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>243</span>             </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">fromObject.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">property</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>244</span>                 </span><span class="NAME">toObject</span><span class="PUNC">[</span><span class="NAME">property</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">fromObject</span><span class="PUNC">[</span><span class="NAME">property</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>245</span>             </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>246</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>247</span>     </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>248</span> 
<span class='line'>249</span>     </span><span class="COMM">/**
<span class='line'>250</span>      * We simulate a 'new'. We want to be able to do a call with a
<span class='line'>251</span>      * dynamic parameter's number.
<span class='line'>252</span>      *
<span class='line'>253</span>      * THIS METHOD IS NOT USED. But I like it :)
<span class='line'>254</span>      *
<span class='line'>255</span>      * @param constructor
<span class='line'>256</span>      *            the constructor
<span class='line'>257</span>      * @param params
<span class='line'>258</span>      *            the parameters
<span class='line'>259</span>      * @returns an object
<span class='line'>260</span>      */</span><span class="WHIT">
<span class='line'>261</span>     </span><span class="NAME">new_</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">constructor</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">params</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>262</span>         </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">Seed</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>263</span>             </span><span class="NAME">constructor.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">params</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>264</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>265</span> 
<span class='line'>266</span>         </span><span class="COMM">// We change the prototype. We do that because it's possible that in the</span><span class="WHIT">
<span class='line'>267</span>         </span><span class="COMM">// constructor there are some calls to functions/properties defined in prototype</span><span class="WHIT">
<span class='line'>268</span>         </span><span class="NAME">Seed.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">constructor.prototype</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>269</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Seed</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>270</span>     </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>271</span> 
<span class='line'>272</span>     </span><span class="COMM">/**
<span class='line'>273</span>      * Call a super method implementation.
<span class='line'>274</span>      *
<span class='line'>275</span>      * @param {object} object
<span class='line'>276</span>      *          the object that call super
<span class='line'>277</span>      * @param {function} baseClass
<span class='line'>278</span>      *          class where the super method is call
<span class='line'>279</span>      * @param {string} methodName
<span class='line'>280</span>      *          name of the method to be invoked
<span class='line'>281</span>      * @param {Array} [params]
<span class='line'>282</span>      *          parameters to use on the super constructor
<span class='line'>283</span>      *
<span class='line'>284</span>      * @return {*} the return value
<span class='line'>285</span>      */</span><span class="WHIT">
<span class='line'>286</span>     </span><span class="NAME">super_method</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">object</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">baseClass</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">methodName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">params</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>287</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">super_</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baseClass.prototype.super_</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>288</span> 
<span class='line'>289</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isNullOrUndefined</span><span class="PUNC">(</span><span class="NAME">super_</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>290</span>             </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">rock.error.RockError</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>291</span>                 </span><span class="NAME">rock.resource.rockResourceManager.getString</span><span class="PUNC">(</span><span class="STRN">'INHERITANCE_NO_SUPER_METHOD_IN_SUPERCLASS'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>292</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>293</span> 
<span class='line'>294</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">method</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">super_.prototype</span><span class="PUNC">[</span><span class="NAME">methodName</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>295</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.isNullOrUndefined</span><span class="PUNC">(</span><span class="NAME">method</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.isFunction</span><span class="PUNC">(</span><span class="NAME">method</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>296</span>             </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">method.apply</span><span class="PUNC">(</span><span class="NAME">object</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">params</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>297</span>         </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>298</span>             </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">rock.error.RockError</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>299</span>                 </span><span class="NAME">rock.resource.rockResourceManager.getString</span><span class="PUNC">(</span><span class="STRN">'INHERITANCE_NO_SUPER_METHOD_IN_SUPERCLASS'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>300</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>301</span>     </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>302</span> 
<span class='line'>303</span>     </span><span class="COMM">/**
<span class='line'>304</span>      * Check if a object is from a type
<span class='line'>305</span>      *
<span class='line'>306</span>      * @param object
<span class='line'>307</span>      *            the object to check
<span class='line'>308</span>      * @param type
<span class='line'>309</span>      *            the type to check
<span class='line'>310</span>      * @returns if the object is instance of type
<span class='line'>311</span>      */</span><span class="WHIT">
<span class='line'>312</span>     </span><span class="NAME">instanceof_</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">object</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">type</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>313</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">object.constructor</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">type</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>314</span>             </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>315</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>316</span> 
<span class='line'>317</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">super_</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">object.super_</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>318</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">interfaces_</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">object.interfaces_</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>319</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">currentInterface</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>320</span>         </span><span class="COMM">// var superCurrentInterface = null;</span><span class="WHIT">
<span class='line'>321</span> 
<span class='line'>322</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.isNullOrUndefined</span><span class="PUNC">(</span><span class="NAME">interfaces_</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>323</span>             </span><span class="COMM">// First we check if some of the interfaces is</span><span class="WHIT">
<span class='line'>324</span>             </span><span class="COMM">// instance of the type</span><span class="WHIT">
<span class='line'>325</span>             </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">interfaces_.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>326</span>                 </span><span class="NAME">currentInterface</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">interfaces_</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>327</span> 
<span class='line'>328</span>                 </span><span class="COMM">// We check if the type is one of the interfaces</span><span class="WHIT">
<span class='line'>329</span>                 </span><span class="COMM">// or some of the interface parents</span><span class="WHIT">
<span class='line'>330</span>                 </span><span class="KEYW">while</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.isNullOrUndefined</span><span class="PUNC">(</span><span class="NAME">currentInterface</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>331</span>                     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">currentInterface</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">type</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>332</span>                         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>333</span>                     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>334</span>                     </span><span class="NAME">currentInterface</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">currentInterface.prototype.super_</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>335</span>                 </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>336</span>             </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>337</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>338</span> 
<span class='line'>339</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isNullOrUndefined</span><span class="PUNC">(</span><span class="NAME">super_</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>340</span>             </span><span class="COMM">// Check whether we are checking vs javascript Object</span><span class="WHIT">
<span class='line'>341</span>             </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">object</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">rock.constants.TYPE_OBJECT</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">Object</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>342</span>                 </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>343</span>             </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>344</span>                 </span><span class="COMM">// We use javascript typeof directly</span><span class="WHIT">
<span class='line'>345</span>                 </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">object</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">type</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>346</span>             </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>347</span>         </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>348</span>             </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.instanceof_</span><span class="PUNC">(</span><span class="NAME">super_.prototype</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">type</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>349</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>350</span> 
<span class='line'>351</span>     </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>352</span> 
<span class='line'>353</span>     </span><span class="COMM">/**
<span class='line'>354</span>      * Dummy function to mark functions as abstract (or interface function
<span class='line'>355</span>      * definition)
<span class='line'>356</span>      */</span><span class="WHIT">
<span class='line'>357</span>     </span><span class="NAME">abstract_</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>358</span>         </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">rock.error.RockError</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>359</span>             </span><span class="NAME">rock.resource.rockResourceManager.getString</span><span class="PUNC">(</span><span class="STRN">'CALLED_METHOD_WITH_NO_IMPLEMENTATION'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>360</span>     </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>361</span> 
<span class='line'>362</span>     </span><span class="COMM">/**
<span class='line'>363</span>      * Checks if a value is null or undefined
<span class='line'>364</span>      *
<span class='line'>365</span>      * @param value
<span class='line'>366</span>      *            the value to check
<span class='line'>367</span>      * @returns {Boolean} true if the value is null or undefined
<span class='line'>368</span>      */</span><span class="WHIT">
<span class='line'>369</span>     </span><span class="NAME">isNullOrUndefined</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>370</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>371</span>     </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>372</span> 
<span class='line'>373</span>     </span><span class="COMM">/**
<span class='line'>374</span>      * Return a function to handle an event. We set the 'this' so we can use a
<span class='line'>375</span>      * function's object to handle an event.
<span class='line'>376</span>      *
<span class='line'>377</span>      * @param this_
<span class='line'>378</span>      *            the object to handle event
<span class='line'>379</span>      * @param handler
<span class='line'>380</span>      *            the function to handle event
<span class='line'>381</span>      * @param {Array} [extraParams]
<span class='line'>382</span>      *            extra params when calling handler
<span class='line'>383</span>      * @returns a function
<span class='line'>384</span>      */</span><span class="WHIT">
<span class='line'>385</span>     </span><span class="NAME">createEventHandler</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this_</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">handler</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">extraParams</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>386</span>         </span><span class="COMM">// TODO: Is there any problem with this here? 'this_' could be released? (memory leaks???)</span><span class="WHIT">
<span class='line'>387</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">params</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>388</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>389</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">rock.isNullOrUndefined</span><span class="PUNC">(</span><span class="NAME">extraParams</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>390</span>             </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">extraParams.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>391</span>                 </span><span class="NAME">params.push</span><span class="PUNC">(</span><span class="NAME">extraParams</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>392</span>             </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>393</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>394</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">eventHandler</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>395</span>             </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">eventHandlerParams</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">event</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>396</span>             </span><span class="NAME">eventHandlerParams</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">eventHandlerParams.concat</span><span class="PUNC">(</span><span class="NAME">params</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>397</span>             </span><span class="NAME">handler.apply</span><span class="PUNC">(</span><span class="NAME">this_</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventHandlerParams</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>398</span>         </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>399</span> 
<span class='line'>400</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">eventHandler</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>401</span>     </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>402</span> 
<span class='line'>403</span>     </span><span class="COMM">/**
<span class='line'>404</span>      * Check if the object has a specified named property.
<span class='line'>405</span>      *
<span class='line'>406</span>      * @param object
<span class='line'>407</span>      *      object to check
<span class='line'>408</span>      * @param property
<span class='line'>409</span>      *      property name
<span class='line'>410</span>      * @returns {boolean}
<span class='line'>411</span>      */</span><span class="WHIT">
<span class='line'>412</span>     </span><span class="NAME">hasProperty</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">object</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">property</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>413</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">property</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">object</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this.isFunction</span><span class="PUNC">(</span><span class="NAME">object</span><span class="PUNC">[</span><span class="NAME">property</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>414</span>     </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>415</span> 
<span class='line'>416</span>     </span><span class="COMM">/**
<span class='line'>417</span>      * Check if the object has a specified named method.
<span class='line'>418</span>      *
<span class='line'>419</span>      * @param object
<span class='line'>420</span>      *      object to check
<span class='line'>421</span>      * @param method
<span class='line'>422</span>      *      method name
<span class='line'>423</span>      * @returns {boolean}
<span class='line'>424</span>      */</span><span class="WHIT">
<span class='line'>425</span>     </span><span class="NAME">hasMethod</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">object</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">method</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>426</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.isFunction</span><span class="PUNC">(</span><span class="NAME">object</span><span class="PUNC">[</span><span class="NAME">method</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>427</span>     </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>428</span> 
<span class='line'>429</span>     </span><span class="COMM">/**
<span class='line'>430</span>      * Replace a method in class by an user agent dependent method
<span class='line'>431</span>      *
<span class='line'>432</span>      * @param pClazz
<span class='line'>433</span>      *      the class to be updated
<span class='line'>434</span>      * @param method
<span class='line'>435</span>      *      the method to be replaced with an user agent dependent implementation
<span class='line'>436</span>      * @param [usePrototype]
<span class='line'>437</span>      *       if the method is in prototype object
<span class='line'>438</span>      */</span><span class="WHIT">
<span class='line'>439</span>     </span><span class="NAME">replaceByUserAgentImplementation</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">pClazz</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">method</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">usePrototype</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>440</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">clazz</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">pClazz</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>441</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">usePrototype</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>442</span>             </span><span class="NAME">clazz</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">clazz</span><span class="PUNC">[</span><span class="STRN">'prototype'</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>443</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>444</span> 
<span class='line'>445</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">methodUserAgentImplementation</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">method</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'_'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">rock.environment.userAgentFamily</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>446</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">methodUserAgent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">clazz</span><span class="PUNC">[</span><span class="NAME">methodUserAgentImplementation</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>447</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.isNullOrUndefined</span><span class="PUNC">(</span><span class="NAME">methodUserAgent</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>448</span>             </span><span class="NAME">clazz</span><span class="PUNC">[</span><span class="NAME">method</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">methodUserAgent</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>449</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>450</span>     </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>451</span> 
<span class='line'>452</span>     </span><span class="COMM">/**
<span class='line'>453</span>      * Check if a string contains some value
<span class='line'>454</span>      *
<span class='line'>455</span>      * @param value
<span class='line'>456</span>      * @param valueToCheck
<span class='line'>457</span>      * @returns {boolean}
<span class='line'>458</span>      */</span><span class="WHIT">
<span class='line'>459</span>     </span><span class="NAME">stringContains</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">valueToCheck</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>460</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isNullOrUndefined</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.isNullOrUndefined</span><span class="PUNC">(</span><span class="NAME">valueToCheck</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>461</span>             </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>462</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>463</span> 
<span class='line'>464</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">value.indexOf</span><span class="PUNC">(</span><span class="NAME">valueToCheck</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>465</span>     </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>466</span> 
<span class='line'>467</span>     </span><span class="COMM">/**
<span class='line'>468</span>      * Internal property to store exposed objects
<span class='line'>469</span>      */</span><span class="WHIT">
<span class='line'>470</span>     </span><span class="NAME">exposedObjects</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>471</span> 
<span class='line'>472</span>     </span><span class="COMM">/**
<span class='line'>473</span>      * Expose an object to world. You can expose an object within an application and then get outside
<span class='line'>474</span>      * (some external button could get the object and call some method)
<span class='line'>475</span>      *
<span class='line'>476</span>      * @param applicationId
<span class='line'>477</span>      *      the id of the application exposing object
<span class='line'>478</span>      * @param objId
<span class='line'>479</span>      *      the id of the exposed object
<span class='line'>480</span>      * @param obj
<span class='line'>481</span>      *      the object to expose
<span class='line'>482</span>      */</span><span class="WHIT">
<span class='line'>483</span>     </span><span class="NAME">expose</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">applicationId</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">objId</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>484</span>         </span><span class="NAME">this.exposedObjects</span><span class="PUNC">[</span><span class="NAME">applicationId</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.exposedObjects</span><span class="PUNC">[</span><span class="NAME">applicationId</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>485</span>         </span><span class="NAME">this.exposedObjects</span><span class="PUNC">[</span><span class="NAME">applicationId</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">objId</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>486</span>     </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>487</span> 
<span class='line'>488</span>     </span><span class="COMM">/**
<span class='line'>489</span>      * Get an exposed object
<span class='line'>490</span>      *
<span class='line'>491</span>      * @param applicationId
<span class='line'>492</span>      *      the id of the application that exposed object
<span class='line'>493</span>      * @param objId
<span class='line'>494</span>      *      the id of the exposed object
<span class='line'>495</span>      *
<span class='line'>496</span>      * @returns the object
<span class='line'>497</span>      */</span><span class="WHIT">
<span class='line'>498</span>     </span><span class="NAME">getExposed</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">applicationId</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">objId</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>499</span>         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">appObjects</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.exposedObjects</span><span class="PUNC">[</span><span class="NAME">applicationId</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>500</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">rock.isNullOrUndefined</span><span class="PUNC">(</span><span class="NAME">appObjects</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>501</span>             </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>502</span>         </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>503</span>             </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">appObjects</span><span class="PUNC">[</span><span class="NAME">objId</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>504</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>505</span>     </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>506</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>507</span> </span></pre></body></html>